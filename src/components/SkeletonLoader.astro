---
/**
 * SkeletonLoader Component
 * Animated placeholder for loading states
 */
interface Props {
  variant?: 'text' | 'title' | 'avatar' | 'card' | 'image' | 'button';
  width?: string;
  height?: string;
  borderRadius?: string;
  lines?: number;
  class?: string;
}

const { 
  variant = 'text',
  width,
  height,
  borderRadius,
  lines = 1,
  class: className = ''
} = Astro.props;

// Default dimensions based on variant
const defaults: Record<string, { width: string; height: string; borderRadius: string }> = {
  text: { width: '100%', height: '1rem', borderRadius: '4px' },
  title: { width: '60%', height: '2rem', borderRadius: '6px' },
  avatar: { width: '48px', height: '48px', borderRadius: '50%' },
  card: { width: '100%', height: '200px', borderRadius: '16px' },
  image: { width: '100%', height: '180px', borderRadius: '12px' },
  button: { width: '120px', height: '44px', borderRadius: '22px' },
};

const d = defaults[variant] || defaults.text;
const finalWidth = width || d.width;
const finalHeight = height || d.height;
const finalRadius = borderRadius || d.borderRadius;
---

<div class={`skeleton-container ${className}`}>
  {Array.from({ length: lines }).map((_, i) => (
    <div 
      class={`skeleton skeleton-${variant}`}
      style={`
        width: ${finalWidth};
        height: ${finalHeight};
        border-radius: ${finalRadius};
        ${i > 0 ? 'margin-top: 0.75rem;' : ''}
        ${i === lines - 1 && lines > 1 ? 'width: 80%;' : ''}
      `}
    />
  ))}
</div>

<style>
  .skeleton-container {
    display: flex;
    flex-direction: column;
  }

  .skeleton {
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.05) 0%,
      rgba(255, 255, 255, 0.1) 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s ease-in-out infinite;
  }

  @keyframes shimmer {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  /* Light theme */
  [data-theme="light"] .skeleton {
    background: linear-gradient(
      90deg,
      rgba(0, 0, 0, 0.06) 0%,
      rgba(0, 0, 0, 0.1) 50%,
      rgba(0, 0, 0, 0.06) 100%
    );
    background-size: 200% 100%;
  }

  /* Card skeleton with multiple elements */
  .skeleton-card {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 1.5rem;
    border: 1px solid var(--border-subtle);
  }

  /* Reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .skeleton {
      animation: none;
      background: rgba(255, 255, 255, 0.08);
    }
    
    [data-theme="light"] .skeleton {
      background: rgba(0, 0, 0, 0.08);
    }
  }
</style>
