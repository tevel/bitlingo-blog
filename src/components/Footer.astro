---
import { DEFAULT_LANG, SUPPORTED_LANGS, BLOG_VERSION } from '../consts';
import { LANGUAGE_DATA } from '../data/vocabulary';

interface Props {
	lang?: string;
}

const { lang } = Astro.props;
const currentLang = lang || DEFAULT_LANG;

// Get current path to determine what page we're on
const currentPath = Astro.url.pathname;
const pathParts = currentPath.split('/').filter(Boolean);

// Determine the base path for language switching
// If we're on a blog page, preserve the slug; otherwise just switch to blog home
let slug = '';
if (pathParts[0] === 'blog' && pathParts.length > 2) {
	// Extract slug after language (e.g., /blog/en/games -> games)
	slug = pathParts.slice(2).join('/');
}

// Language names mapping
const langNames: Record<string, string> = {
	'en': 'English',
	'es': 'Espa√±ol',
	'fr': 'Fran√ßais',
	'de': 'Deutsch',
	'it': 'Italiano',
	'pt': 'Portugu√™s',
	'ru': '–†—É—Å—Å–∫–∏–π',
	'zh': '‰∏≠Êñá',
	'ja': 'Êó•Êú¨Ë™û',
	'ko': 'ÌïúÍµ≠Ïñ¥',
	'ar': 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',
	'hi': '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä',
	'tr': 'T√ºrk√ße',
	'pl': 'Polski',
	'uk': '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞',
	'he': '◊¢◊ë◊®◊ô◊™',
};

const today = new Date();
---

<footer>
	<div class="footer-content">
		<div class="footer-brand">
			<div class="footer-logo">
				<img src="/favicon.svg" alt="BitLingo" class="footer-logo-img" width="40" height="40" />
				<span class="brand-text"><span class="title-bit">Bit</span><span class="title-lingo">Lingo</span></span>
			</div>
			<p class="footer-tagline">Audio-first vocabulary learning for busy people.</p>
		</div>
		
		<div class="footer-links">
			<div class="footer-section">
				<h4>Product</h4>
				<a href="https://bitlingo.app" target="_blank" rel="noopener noreferrer">Open the App</a>
				<a href={`/blog/${DEFAULT_LANG}`}>Blog</a>
				<a href="/blog/about">About</a>
			</div>
			<div class="footer-section">
				<h4>Resources</h4>
				<a href={`/blog/${DEFAULT_LANG}/commute-hands-free/`}>Commute Guide</a>
				<a href={`/blog/${DEFAULT_LANG}/habit-playbook-bitlingo/`}>Habit Playbook</a>
				<a href={`/blog/${DEFAULT_LANG}/offline-practice-guide/`}>Offline Guide</a>
			</div>
			<div class="footer-section">
				<h4>Languages</h4>
				{SUPPORTED_LANGS.map((langCode) => {
					const href = slug ? `/blog/${langCode}/${slug}` : `/blog/${langCode}`;
					const isActive = langCode === currentLang;
					return (
						<a 
							href={href} 
							class={isActive ? 'lang-link active' : 'lang-link'}
							aria-current={isActive ? 'page' : undefined}
						>
							{langNames[langCode] || langCode.toUpperCase()}
						</a>
					);
				})}
			</div>
			<div class="footer-section">
				<h4>Connect</h4>
				<a href="/rss.xml">RSS Feed</a>
			</div>
		</div>
	</div>
	
	<div class="footer-bottom">
		<div class="footer-badges">
			<span class="badge">üéß Audio-First</span>
			<span class="badge">‚úã Hands-Free</span>
			<span class="badge">üì¥ Offline</span>
			<span class="badge">üÜì Free</span>
		</div>
		<p class="copyright">&copy; {today.getFullYear()} BitLingo. Learn languages while you live your life.</p>
		<p class="version">Version {BLOG_VERSION}</p>
	</div>
	
	<div class="footer-glow"></div>
</footer>

<style>
	footer {
		position: relative;
		margin-top: 4rem;
		padding: 3rem 1.5rem 2rem;
		background: linear-gradient(180deg, transparent 0%, rgba(26, 54, 93, 0.5) 100%);
		border-top: 1px solid rgba(245, 166, 35, 0.15);
		overflow: hidden;
	}
	
	.footer-content {
		display: flex;
		flex-wrap: wrap;
		gap: 3rem;
		max-width: 1200px;
		margin: 0 auto;
		position: relative;
		z-index: 1;
	}
	
	/* Brand section */
	.footer-brand {
		flex: 1;
		min-width: 250px;
	}
	
	.footer-logo {
		display: flex;
		align-items: center;
		gap: 0.75rem;
		margin-bottom: 1rem;
	}
	
	.footer-logo-img {
		width: 40px;
		height: 40px;
		flex-shrink: 0;
		display: block;
		filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.3));
	}
	
	.brand-text {
		font-family: 'Nunito', system-ui, sans-serif;
		font-size: 1.8rem;
		font-weight: 800;
		letter-spacing: 1px;
		line-height: 1.2;
	}
	
	/* "Bit" - Gold color (matches mascot and accent) */
	.brand-text .title-bit {
		color: #ffd700;
		text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
	}
	
	/* "Lingo" - White/primary text color */
	.brand-text .title-lingo {
		color: #f0f4f8;
		text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
	}
	
	.footer-tagline {
		color: var(--text-muted);
		font-size: 0.95rem;
		margin: 0;
		max-width: 280px;
	}
	
	/* Links sections */
	.footer-links {
		display: flex;
		flex-wrap: wrap;
		gap: 2.5rem;
	}
	
	.footer-section {
		display: flex;
		flex-direction: column;
		gap: 0.75rem;
	}
	
	.footer-section h4 {
		font-size: 0.85rem;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: #f5a623;
		margin: 0 0 0.5rem;
	}
	
	.footer-section a {
		color: var(--text-secondary);
		font-size: 0.95rem;
		transition: all 0.3s ease;
	}
	
	.footer-section a:hover {
		color: #f5a623;
		padding-left: 0.25rem;
	}
	
	.lang-link {
		position: relative;
	}
	
	.lang-link.active {
		color: #f5a623;
		font-weight: 600;
	}
	
	.lang-link.active::before {
		content: '‚úì';
		display: inline-block;
		margin-right: 0.25rem;
		color: #f5a623;
	}
	
	/* Bottom section */
	.footer-bottom {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 1.5rem;
		max-width: 1200px;
		margin: 3rem auto 0;
		padding-top: 2rem;
		border-top: 1px solid rgba(245, 166, 35, 0.1);
		position: relative;
		z-index: 1;
	}
	
	.footer-badges {
		display: flex;
		flex-wrap: wrap;
		justify-content: center;
		gap: 0.75rem;
	}
	
	.badge {
		display: inline-flex;
		align-items: center;
		padding: 0.5rem 1rem;
		background: rgba(245, 166, 35, 0.1);
		border: 1px solid rgba(245, 166, 35, 0.2);
		border-radius: 50px;
		font-size: 0.8rem;
		font-weight: 500;
		color: var(--text-secondary);
	}
	
	.copyright {
		color: var(--text-muted);
		font-size: 0.85rem;
		margin: 0;
		text-align: center;
	}

	.version {
		color: var(--text-muted);
		font-size: 0.75rem;
		margin: 0;
		text-align: center;
		opacity: 0.6;
		font-family: 'Courier New', monospace;
	}
	
	/* Decorative glow */
	.footer-glow {
		position: absolute;
		bottom: -100px;
		left: 50%;
		transform: translateX(-50%);
		width: 600px;
		height: 200px;
		background: radial-gradient(ellipse, rgba(245, 166, 35, 0.1) 0%, transparent 70%);
		pointer-events: none;
	}
	
	/* Responsive */
	@media (max-width: 768px) {
		footer {
			padding: 2rem 1rem;
		}
		
		.footer-content {
			flex-direction: column;
			gap: 2rem;
		}
		
		.footer-links {
			gap: 2rem;
		}
		
		.footer-section {
			min-width: 120px;
		}
		
		.footer-badges {
			gap: 0.5rem;
		}
		
		.badge {
			padding: 0.4rem 0.8rem;
			font-size: 0.75rem;
		}
	}
</style>
